{% extends "shared/layout-left-nav.html" %}

{% block title %}All User Requirements{% endblock %}

{% block left_nav %}
{% include "internship-program/left-nav.html" %}
{% endblock %}

{% block content %}

<div class="title">
    <h4>
        All user requirements for '{{ requirement.name }}'
    </h4>
</div>

<section>
    <div id="user-requirements-grid"></div>
</section>

<script>
    grid = new gridjs.Grid({
        className: {
            tbody: 'gridjs-row-clickable'
        },
        columns: [
            { name: 'id', hidden: true },
            'Index Number',
            'Full name',
            'Status',
            'Start date',
            'End date',
        ],
        server: {
            url: "{{ apiEndpoint|e('js') }}",
            then: data => data.map(u => [
                u.id,
                u.indexNumber,
                u.fullName,
                u.status,
                u.startDate,
                u.endDate
            ])
        },
        search: {
            server: {
                url: (prev, keyword) => `${prev}?q=${keyword}`
            }
        },
    });
    grid.render(document.getElementById("user-requirements-grid"));
    grid.on('rowClick', (e, row) => {
        window.location.href = `/internship-program/monitoring/students/${row.cells[0].data}`;
    });
</script>

{% endblock %}